<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Computing observed T-statistics (T for Traits) and null expectations. — Tstats • cati</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Computing observed T-statistics (T for Traits) and null expectations. — Tstats"><meta name="description" content="Computing observed T-statistics (T for Traits) as three ratios of variance, namely T_IP.IC, T_IC.IR and T_PC.PR. This function can also return the distribution of this three statistics under null models."><meta property="og:description" content="Computing observed T-statistics (T for Traits) as three ratios of variance, namely T_IP.IC, T_IC.IR and T_PC.PR. This function can also return the distribution of this three statistics under null models."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-secondary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cati</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/adrientaudiere/cati/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Computing observed T-statistics (T for Traits) and null expectations.</h1>

      <div class="d-none name"><code>Tstats.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computing observed T-statistics (T for Traits) as three ratios of variance, namely T_IP.IC, T_IC.IR and T_PC.PR. This function can also return the distribution of this three statistics under null models.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Tstats</span><span class="op">(</span><span class="va">traits</span>, <span class="va">ind.plot</span>, <span class="va">sp</span>, SE <span class="op">=</span> <span class="fl">0</span>, reg.pool <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>  SE.reg.pool <span class="op">=</span> <span class="cn">NULL</span>, nperm <span class="op">=</span> <span class="fl">99</span>, printprogress <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>  independantTraits <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">sum_Tstats</span><span class="op">(</span><span class="va">x</span>, val.quant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">ses.Tstats</span><span class="op">(</span><span class="va">x</span>, val.quant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="co"># S3 method for class 'Tstats'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">height</span>, val.quant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span>, </span>
<span>  col.index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"purple"</span>, <span class="st">"olivedrab3"</span>, <span class="st">"white"</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span>                 </span>
<span>  <span class="co"># S3 method for class 'Tstats'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="st">"normal"</span>, col.index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"purple"</span>, <span class="st">"olivedrab3"</span><span class="op">)</span>,</span>
<span>  add.conf <span class="op">=</span> <span class="cn">TRUE</span>, color.cond <span class="op">=</span> <span class="cn">TRUE</span>, val.quant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="co"># S3 method for class 'Tstats'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="co"># S3 method for class 'Tstats'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-traits">traits<a class="anchor" aria-label="anchor" href="#arg-traits"></a></dt>
<dd><p>Individual Matrix of traits with traits in columns. For one trait, use as.matrix().</p></dd>

	
	<dt id="arg-ind-plot">ind.plot<a class="anchor" aria-label="anchor" href="#arg-ind-plot"></a></dt>
<dd><p>Factor defining the name of the plot in which the individual is.</p></dd>

	
	<dt id="arg-sp">sp<a class="anchor" aria-label="anchor" href="#arg-sp"></a></dt>
<dd><p>Factor defining the species which the individual belong to.</p></dd>

	
	<dt id="arg-se">SE<a class="anchor" aria-label="anchor" href="#arg-se"></a></dt>
<dd><p>A single value or vector of standard errors associated with each traits. Especially allow to handle measurement errors. Not used with populational null model.</p></dd>

	
	<dt id="arg-reg-pool">reg.pool<a class="anchor" aria-label="anchor" href="#arg-reg-pool"></a></dt>
<dd><p>Regional pool data for traits. If not informed, 'traits' is considered as the regional pool. This matrix need to be larger (more rows) than the matrix "traits". Use only for null model 2 (regional.ind).</p></dd>
	
	
	<dt id="arg-se-reg-pool">SE.reg.pool<a class="anchor" aria-label="anchor" href="#arg-se-reg-pool"></a></dt>
<dd><p>A single value or vector of standard errors associated with each traits in each regional pool. Use only if reg.pool is used. Need to have the same dimension as reg.pool.</p>
<p></p></dd>

	
	<dt id="arg-nperm">nperm<a class="anchor" aria-label="anchor" href="#arg-nperm"></a></dt>
<dd><p>Number of permutations. If NULL, only observed values are returned;</p></dd>

	
	<dt id="arg-printprogress">printprogress<a class="anchor" aria-label="anchor" href="#arg-printprogress"></a></dt>
<dd><p>Logical value; print progress during the calculation or not.</p></dd>

	
	<dt id="arg-independanttraits">independantTraits<a class="anchor" aria-label="anchor" href="#arg-independanttraits"></a></dt>
<dd><p>Logical value (default: TRUE). If independantTraits is true (default), each traits is sample independently in null models, if not, each lines of the matrix are randomized, keeping the relation (and trade-off) among traits.</p></dd>

	
	<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object of class Tstats.</p></dd>

	
	<dt id="arg-height">height<a class="anchor" aria-label="anchor" href="#arg-height"></a></dt>
<dd><p>An object of class Tstats.</p></dd>

	
	<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An object of class Tstats.</p></dd>

	
	<dt id="arg-val-quant">val.quant<a class="anchor" aria-label="anchor" href="#arg-val-quant"></a></dt>
<dd><p>Numeric vectors of length 2, giving the quantile to calculation confidence interval. By default val.quant = c(0.025,0.975) for a bilateral test with alpha = 5%.</p></dd>

	
	<dt id="arg-ylim">ylim<a class="anchor" aria-label="anchor" href="#arg-ylim"></a></dt>
<dd><p>Numeric vectors of length 2, giving the y coordinates range</p></dd>

	
	<dt id="arg-col-index">col.index<a class="anchor" aria-label="anchor" href="#arg-col-index"></a></dt>
<dd><p>A vector of three color correspond to the three T-statistics.</p></dd>

	
	<dt id="arg-color-cond">color.cond<a class="anchor" aria-label="anchor" href="#arg-color-cond"></a></dt>
<dd><p>Logical value; If color.cond = TRUE, color points indicate T-statistics values significatively different from the null model and grey points are not different from null model.</p></dd>

	
	<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>For the plot function, type of plot. Possible type = "simple", "simple_range", "normal", "barplot" and "bytraits".
		For the summary function, type of summary statistics. Either "binary", "percent", "p.value", "site" or "all".</p></dd>

	
	<dt id="arg-add-conf">add.conf<a class="anchor" aria-label="anchor" href="#arg-add-conf"></a></dt>
<dd><p>Logical value; Add confidence intervals or not.</p></dd>

	
	<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Any additional arguments are passed to the plot function creating the core of the plot and can be used to adjust the look of resulting graph. See <code><a href="plot.listofindex.html">plot.listofindex</a></code> for more arguments.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><b>S3 method plot:</b></p>	
<p>-<em>Normal</em> type plot means, standard deviations, ranges and confidence intervals of T-statistics.</p>	
<p>-<em>Simple_range</em> type plot means, standard deviations and range of T-statistics</p>	
<p>-<em>Simple</em> type plot T-statistics for each site and traits and the mean confidence intervals by traits</p>	
<p>-<em>Barplot</em> type plot means, standard deviations and confidence intervals of T-statistics in a barplot fashion</p>	
<p>-<em>Bysites</em> type plot each metrics for each sites</p>	
<p>-<em>Bytraits</em> type plot each metrics for each traits</p>	
	
<p><b>S3 method print</b>: print the structure if the object of class Tstats</p>	
	
<p><b>S3 method summary:</b> print the summary statistics of the three T-statistics</p>	
	
<p><b>Method summary sum_Tstats:</b></p>	
<p>-<em>Binary</em> type only test if a T-statistics is significatively different from the null expectation for each trait.</p>	
<p>-<em>Percent</em> type determine the percentage of sites were the T-statistics is significatively different from the null expectation for each trait. Asterix shows global significance of the test.</p>	
<p>-<em>P-value</em> type determine the p-value (two unilateral tests) of the T-statistics for each trait and sites.</p>	
<p>-<em>Site</em> type allows to know in which sites T-statistics deviate from the null expectation.</p>	
<p>-<em>All</em> type do all the precedent type of summary.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of statistics:</p>	
<p></p>
<dl><dt>Tstats$T_IP.IC</dt>
<dd><p>Observed ratio between variance of individuals in populations and individuals in communities</p></dd>

	<dt>Tstats$T_IC.IR</dt>
<dd><p>Observed ratio between variance of individuals in communities and individuals in the region</p></dd>

	<dt>Tstats$T_PC.PR</dt>
<dd><p>Observed ratio between variance of populations in communities and populations in the region</p></dd>

	
	<dt>$Tstats$T_IP.IC_nm</dt>
<dd><p>If nperm is numeric; Result of simulation for T_IP.IC</p></dd>

	<dt>$Tstats$T_IC.IR_nm</dt>
<dd><p>If nperm is numeric; Result of simulation for T_IC.IR</p></dd>

	<dt>$Tstats$T_PC.PR_nm</dt>
<dd><p>If nperm is numeric; Result of simulation for T_PC.PR</p></dd>

	
	<dt>$variances$var_IP</dt>
<dd><p>variance of individuals within populations</p></dd>

	<dt>$variances$var_PC</dt>
<dd><p>variance of populations within communities</p></dd>

	<dt>$variances$var_CR</dt>
<dd><p>variance of communities within the region</p></dd>

	<dt>$variances$var_IC</dt>
<dd><p>variance of individuals within communities</p></dd>

	<dt>$variances$var_PR</dt>
<dd><p>variance of populations within the region</p></dd>

	<dt>$variances$var_IR</dt>
<dd><p>variance of individuals within the region</p></dd>

	
	<dt>$variances$var_IP_nm1</dt>
<dd><p>variance of individuals within populations in null model 1</p></dd>

	<dt>$variances$var_PC_nm2sp</dt>
<dd><p>variance of populations within communities in null model 2sp</p></dd>

	<dt>$variances$var_IC_nm1</dt>
<dd><p>variance of communities within the region in null model 1</p></dd>

	<dt>$variances$var_IC_nm2</dt>
<dd><p>variance of individuals within communities in null model 2</p></dd>

	<dt>$variances$var_PR_nm2sp</dt>
<dd><p>variance of populations within the region in null model 2sp</p></dd>

	<dt>$variances$var_IR_nm2</dt>
<dd><p>variance of individuals within the region in null model 2</p></dd>

	
	<dt>$traits</dt>
<dd><p>traits data</p></dd>

 	<dt>$ind.plot</dt>
<dd><p>name of the plot in which the individual is</p></dd>

 	<dt>$sp</dt>
<dd><p>groups (e.g. species) which the individual belong to</p></dd>

 	
 	<dt>$call</dt>
<dd><p>call of the function Tstats</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Violle, Cyrille, Brian J. Enquist, Brian J. McGill, Lin Jiang, Cecile H. Albert, Catherine Hulshof, Vincent Jung, et Julie Messier. 2012. The return of the variance: intraspecific variability in community ecology. Trends in Ecology &amp; Evolution 27 (4): 244-252. doi:10.1016/j.tree.2011.11.014.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Adrien Taudiere and Cyrille Violle</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="ComIndex.html">ComIndex</a></code>;
	<code><a href="ComIndexMulti.html">ComIndexMulti</a></code>;
	<code><a href="plotCorTstats.html">plotCorTstats</a></code>;
	<code><a href="plotSESvar.html">plotSESvar</a></code>;
	<code><a href="plot.listofindex.html">plot.listofindex</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">finch.ind</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="va">res.finch</span> <span class="op">&lt;-</span> <span class="fu">Tstats</span><span class="op">(</span><span class="va">traits.finch</span>, ind.plot <span class="op">=</span> <span class="va">ind.plot.finch</span>, </span></span>
<span class="r-in"><span>  sp <span class="op">=</span> <span class="va">sp.finch</span>, nperm <span class="op">=</span> <span class="fl">9</span>, print <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="va">res.finch</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#Tstats class is associated to S3 methods plot, barplot and summary</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res.finch</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res.finch</span>, type <span class="op">=</span> <span class="st">"simple"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res.finch</span>, type <span class="op">=</span> <span class="st">"simple_range"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res.finch</span>, type <span class="op">=</span> <span class="st">"barplot"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res.finch</span>, type <span class="op">=</span> <span class="st">"bysites"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res.finch</span>, type <span class="op">=</span> <span class="st">"bytraits"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu">sum_Tstats</span><span class="op">(</span><span class="va">res.finch</span>, type <span class="op">=</span> <span class="st">"binary"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">sum_Tstats</span><span class="op">(</span><span class="va">res.finch</span>, type <span class="op">=</span> <span class="st">"site"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">sum_Tstats</span><span class="op">(</span><span class="va">res.finch</span>, type <span class="op">=</span> <span class="st">"p.value"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">res.finch</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co">#### An other way to see "ses values" of T-statistics</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># Custom theme (from rasterVis package)</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://oscarperpinan.github.io/rastervis/" class="external-link">rasterVis</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="va">my.theme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rasterVis/man/rasterTheme.html" class="external-link">BuRdTheme</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Customize the colorkey</span></span></span>
<span class="r-in"><span>  <span class="va">my.ckey</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">my.theme</span><span class="op">$</span><span class="va">regions</span><span class="op">$</span><span class="va">col</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/levelplot.html" class="external-link">levelplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="ses.html">ses</a></span><span class="op">(</span><span class="va">res.finch</span><span class="op">$</span><span class="va">Tstats</span><span class="op">$</span><span class="va">T_IP.IC</span>,<span class="va">res.finch</span><span class="op">$</span><span class="va">Tstats</span><span class="op">$</span><span class="va">T_IP.IC_nm</span><span class="op">)</span><span class="op">$</span><span class="va">ses</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>  colorkey <span class="op">=</span> <span class="va">my.ckey</span>, par.settings <span class="op">=</span> <span class="va">my.theme</span>,border <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co">#### Use a different regional pool than the binding of studied communities</span></span></span>
<span class="r-in"><span>  <span class="co">#create a random regional pool for the example</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="va">reg.p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">traits.finch</span>, <span class="va">traits.finch</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2000</span>,<span class="fl">300</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="va">res.finch2</span> <span class="op">&lt;-</span> <span class="fu">Tstats</span><span class="op">(</span><span class="va">traits.finch</span>, ind.plot <span class="op">=</span> <span class="va">ind.plot.finch</span>, </span></span>
<span class="r-in"><span>     sp <span class="op">=</span> <span class="va">sp.finch</span>, reg.pool<span class="op">=</span><span class="va">reg.p</span>, nperm <span class="op">=</span> <span class="fl">9</span>, print <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  </span></span>
<span class="r-in"><span>      </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="as.listofindex.html">as.listofindex</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">res.finch</span>,<span class="va">res.finch2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co">#### Use a different regional pool for each communities</span></span></span>
<span class="r-in"><span>  <span class="co">#create a random regional pool for each communities for the example</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="va">list.reg.p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">traits.finch</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">290</span>,<span class="fl">200</span><span class="op">)</span>, <span class="op">]</span>, <span class="va">traits.finch</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">100</span><span class="op">:</span><span class="fl">1200</span>,<span class="fl">300</span><span class="op">)</span>, <span class="op">]</span>, </span></span>
<span class="r-in"><span>  <span class="va">traits.finch</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">100</span><span class="op">:</span><span class="fl">1500</span>, <span class="fl">1000</span><span class="op">)</span>, <span class="op">]</span>, <span class="va">traits.finch</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">300</span><span class="op">:</span><span class="fl">800</span>,<span class="fl">300</span><span class="op">)</span>, <span class="op">]</span>,</span></span>
<span class="r-in"><span>  <span class="va">traits.finch</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">:</span><span class="fl">2000</span>, <span class="fl">500</span><span class="op">)</span>, <span class="op">]</span>, <span class="va">traits.finch</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">100</span><span class="op">:</span><span class="fl">900</span>, <span class="fl">700</span><span class="op">)</span>, <span class="op">]</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Warning: the regional pool need to be larger than the observed communities</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">ind.plot.finch</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># For exemple, the third community need a regional pool of more than 981 individuals</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>  <span class="va">res.finch3</span> <span class="op">&lt;-</span> <span class="fu">Tstats</span><span class="op">(</span><span class="va">traits.finch</span>, ind.plot <span class="op">=</span> <span class="va">ind.plot.finch</span>, </span></span>
<span class="r-in"><span>     sp <span class="op">=</span> <span class="va">sp.finch</span>, reg.pool<span class="op">=</span><span class="va">list.reg.p</span>, nperm <span class="op">=</span> <span class="fl">9</span>, print <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  </span></span>
<span class="r-in"><span>      </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="as.listofindex.html">as.listofindex</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">res.finch</span>, <span class="va">res.finch2</span>, <span class="va">res.finch3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#### Use the standard errors of measure in the analysis (argument SE)</span></span></span>
<span class="r-in"><span>  <span class="va">res.finch.SE0</span> <span class="op">&lt;-</span> <span class="fu">Tstats</span><span class="op">(</span><span class="va">traits.finch</span>, ind.plot <span class="op">=</span> <span class="va">ind.plot.finch</span>, </span></span>
<span class="r-in"><span>  sp <span class="op">=</span> <span class="va">sp.finch</span>, SE <span class="op">=</span> <span class="fl">0</span>, print <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>  <span class="va">res.finch.SE5</span> <span class="op">&lt;-</span> <span class="fu">Tstats</span><span class="op">(</span><span class="va">traits.finch</span>, ind.plot <span class="op">=</span> <span class="va">ind.plot.finch</span>, </span></span>
<span class="r-in"><span>  sp <span class="op">=</span> <span class="va">sp.finch</span>, SE <span class="op">=</span> <span class="fl">5</span>, print <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="as.listofindex.html">as.listofindex</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">res.finch.SE0</span>, <span class="va">res.finch.SE5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adrien Taudiere, Cyrille Violle.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

